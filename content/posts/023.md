= yaml =
title: Starting Fresh
date: 2013-10-19
= yaml =


Finished up the last of [Sam Lacanshires basic HTML5 game tutorials](http://html5gamedev.samlancashire.com/category/tutorials/) and I moved on to the more advance tutorial that explains how to loop a sprite animation. I tried to combine the animation tutorial with the game tutorials I already had working but that went poorly and for some reason I could'nt even get the canvas to display.

As I am understanding more of how a game loop works(and just javascript in gernal really) we decided to scrap Nomad Axe as it was and make it more static. Maybe 'refactor' is a better term here. A motivator for this was a [talk](https://vimeo.com/74008847) that came out of JSLA about setting up a javascript foundation for a basic game and these [slides](http://hughsk.github.io/campjs-talk/) which walk through how to use browserfy which is basically a library that I will use to help me make Nomad Axe.

In the tutorials I wen through last week there is a run loop and an update loop that basically check to see if the game or the canvas has any changes. If there are then the canvas updates the changes and renders what you see. Basically they were functions in the code that looked like this:

//checking for key presses
function update(mod) {
	if (37 in keysDown) {
		mySprite.state = 2; //left
		mySprite.x -= mySprite.speed * mod;
	}

	if (38 in keysDown) {
		mySprite.state = 3; //up
		mySprite.y -= mySprite.speed * mod;
	}

	if (39 in keysDown) {
		mySprite.state = 0; //right
		mySprite.x += mySprite.speed * mod;
	}

	if (40 in keysDown) {
		mySprite.state = 1; //down
		mySprite.y += mySprite.speed * mod;
	}
//this checks to see if the sprite touches the item
	if (
		mySprite.x < item.x + item.width &&
		mySprite.x + mySprite.width > item.x &&
		mySprite.y < item.y + item.height &&
		mySprite.y + mySprite.height > item.y
	) {
		item.x = Math.random() * canvas.width;
		item.y = Math.random() * canvas.height;
		itemCounter ++;
	}
}

function run() {
	update((Date.now() - time) / 1000);
	if (game.images == game.imagesLoaded) {
 	}
	time = Date.now();

Originally Nomad Axe would have been like this or would have used a complex engine to do the same thing which ultimately could have proved to be clunky. Now using the slide mentioned early Nomad Axe looks like this:

var domready = require('domready')
var loaded = require('image-loaded')

domready(function(){
  console.log('dom loaded')

  var canvas = document.querySelector('canvas')
  var ctx = canvas.getContext('2d')
  console.log(ctx)

  canvas.height = document.height
  canvas.width = document.width

  var image = document.createElement('img')
  image.src = '/images/hero.png'

  loaded(image, function(err){
  	if (err) console.error(err)
  	ctx.drawImage(image, document.width/2, document.height /2)
  })
})


 Now this is a little unfair because the tutorial code is actually checking for key presses and I haven't hooked those up in the new version of Nomad Axe yet. However there is a lot more code in the tutorial that straightens out some other things. The code from Nomad Axe is currently only displaying an image. It can't move or anything however the variable 'loaded' is  requiring a tool from the browserify library called 'image-loaded.' It checks to see if an image is loaded or not. When the game is actually running there will be a lot of images to check for. Now instead of writing all of those 'checks' out by hand I can use the variable 'loaded' to save a bunch of time.
